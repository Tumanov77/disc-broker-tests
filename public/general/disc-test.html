<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DISC-—Ç–µ—Å—Ç –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .header p {
            color: #6c757d;
            font-size: 16px;
        }

        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .user-data {
            color: #333;
            font-weight: 500;
        }

        .logout-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background 0.3s ease;
        }

        .logout-btn:hover {
            background: #c82333;
        }

        .form-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            background: #f8f9fa;
        }

        .form-section h3 {
            color: #495057;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        .form-group input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #ced4da;
            border-radius: 4px;
            font-size: 16px;
            transition: border-color 0.15s ease-in-out;
        }

        .form-group input[type="text"]:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }

        .instructions {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 4px;
        }

        .instructions h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .instructions p {
            margin-bottom: 8px;
        }

        .block {
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 6px;
        }

        .block h4 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .statement {
            margin-bottom: 12px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #e9ecef;
        }

        .statement label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 15px;
        }

        .statement input[type="radio"] {
            margin-right: 12px;
            transform: scale(1.2);
        }

        .submit-btn {
            background: #28a745;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 30px;
            transition: background-color 0.15s ease-in-out;
        }

        .submit-btn:hover {
            background: #218838;
        }

        .submit-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: #e3f2fd;
            border-radius: 6px;
        }

        .loading.show {
            display: block;
        }

        .success-message {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            text-align: center;
        }

        .success-message.show {
            display: block;
        }

        .success-message h3 {
            color: #155724;
            margin-bottom: 10px;
        }

        .success-message p {
            color: #155724;
            margin-bottom: 8px;
        }

        .error-message {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            color: #721c24;
        }

        .error-message.show {
            display: block;
        }

        .results {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
        }

        .results h3 {
            color: #155724;
            margin-bottom: 15px;
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .score-item {
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 6px;
            border: 2px solid #e9ecef;
        }

        .score-item.dominant { border-color: #dc3545; }
        .score-item.influencer { border-color: #fd7e14; }
        .score-item.stable { border-color: #20c997; }
        .score-item.conscientious { border-color: #6f42c1; }

        .score-value {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .score-label {
            font-size: 14px;
            color: #6c757d;
        }

        .assessment {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }

        .assessment h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .assessment p {
            color: #856404;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 15px;
            }
            
            .score-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .update-timestamp {
            position: fixed;
            bottom: 10px;
            right: 10px;
            color: white;
            font-size: 12px;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 5px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="user-info" id="userInfo" style="display: none;">
                <div class="user-data">
                    <span id="userName"></span> (<span id="userTelegram"></span>)
                </div>
                <button class="logout-btn" onclick="logout()">–í—ã–π—Ç–∏</button>
            </div>
            <h1>–¢–µ—Å—Ç 1</h1>
            <p>–û–±—â–µ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</p>
        </div>

        <form id="discForm">

            <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ -->
            <div class="instructions">
                <h3>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞</h3>
                <p>–í –∫–∞–∂–¥–æ–º –±–ª–æ–∫–µ –≤—ã–±–µ—Ä–∏—Ç–µ:</p>
                <p>‚úî <strong>—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –≤–∞—Å</strong></p>
                <p>‚úñ <strong>—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–∏–º–µ–Ω–µ–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –≤–∞—Å</strong></p>
                <p><em>–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –≤ –∫–∞–∂–¥–æ–º –±–ª–æ–∫–µ –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –û–î–ù–û —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–∞–∫ "–Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–µ" –∏ –û–î–ù–û –∫–∞–∫ "–Ω–∞–∏–º–µ–Ω–µ–µ –ø–æ—Ö–æ–∂–µ".</em></p>
            </div>

            <!-- –ë–ª–æ–∫–∏ —Ç–µ—Å—Ç–∞ -->
            <div id="testBlocks"></div>

            <button type="submit" class="submit-btn" id="submitBtn">
                –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
            </button>
        </form>

        <div id="loading" class="loading">
            <h3>‚è≥ –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...</h3>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ, –º—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤–∞—à–∏ –æ—Ç–≤–µ—Ç—ã</p>
        </div>

        <div id="successMessage" class="success-message">
            <h3>‚úÖ –¢–µ—Å—Ç 1 –∑–∞–≤–µ—Ä—à–µ–Ω!</h3>
            <p>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ HR –æ—Ç–¥–µ–ª</p>
            <p>–¢–µ–ø–µ—Ä—å –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¢–µ—Å—Ç 2</p>
            <button onclick="window.location.href='/test2'" style="margin-top: 15px; padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px;">
                –ü–µ—Ä–µ–π—Ç–∏ –∫ –¢–µ—Å—Ç—É 2
            </button>
        </div>

        <div id="errorMessage" class="error-message">
            <h3>‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ</h3>
            <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é</p>
        </div>

    </div>

    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const candidateData = localStorage.getItem('candidateData');
            
            console.log('Test page loaded, checking auth:');
            console.log('isLoggedIn:', isLoggedIn);
            console.log('candidateData:', candidateData);
            
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é
            if (isLoggedIn !== 'true' || !candidateData || candidateData.trim() === '') {
                console.log('User not logged in, redirecting to main page');
                localStorage.clear();
                sessionStorage.clear();
                window.location.href = '/';
                return;
            }
            
            try {
                const userData = JSON.parse(candidateData);
                if (!userData.fullName || !userData.telegram || !userData.role) {
                    console.log('Incomplete user data, redirecting to main page');
                    localStorage.clear();
                    sessionStorage.clear();
                    window.location.href = '/';
                    return;
                }
                console.log('User is authorized:', userData.fullName);
            } catch (error) {
                console.error('Error parsing user data:', error);
                localStorage.clear();
                sessionStorage.clear();
                window.location.href = '/';
                return;
            }
            
            checkLoginStatus();
        });

        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const candidateData = localStorage.getItem('candidateData');
            
            if (isLoggedIn && candidateData) {
                const userData = JSON.parse(candidateData);
                document.getElementById('userName').textContent = userData.fullName;
                document.getElementById('userTelegram').textContent = userData.telegram;
                document.getElementById('userInfo').style.display = 'flex';
            } else {
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                window.location.href = '/entry.html';
            }
        }

        function logout() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('candidateData');
            localStorage.removeItem('testProgress');
            window.location.href = '/entry.html';
        }

        function updateTestProgress(stageNumber) {
            const progress = JSON.parse(localStorage.getItem('testProgress') || '{}');
            progress[`stage${stageNumber}Completed`] = true;
            localStorage.setItem('testProgress', JSON.stringify(progress));
        }

        const discBlocks = [
            {
                statements: [
                    { text: "–ª—é–±–ª—é –±—ã—Å—Ç—Ä–æ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è", type: "D" },
                    { text: "–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é, —á—Ç–æ–±—ã –≤—Å—ë –±—ã–ª–æ –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º", type: "C" },
                    { text: "–ª–µ–≥–∫–æ –∑–∞–≤–æ–∂—É –Ω–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞", type: "I" },
                    { text: "—Ü–µ–Ω—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–º–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∫–æ–Ω–∫—É—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–±–µ–∂–¥–∞—Ç—å", type: "D" },
                    { text: "—è –æ–±—ã—á–Ω–æ –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω –∫ –¥–µ—Ç–∞–ª—è–º", type: "C" },
                    { text: "—è –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é –¥—Ä—É–≥–∏—Ö —Å–≤–æ–∏–º —ç–Ω—Ç—É–∑–∏–∞–∑–º–æ–º", type: "I" },
                    { text: "—è –≤–µ—Ä–µ–Ω —Å–≤–æ–∏–º –ø—Ä–∏–≤—ã—á–∫–∞–º –∏ –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—è–º", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é —Ä–∏—Å–∫–æ–≤–∞—Ç—å", type: "D" },
                    { text: "–≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—é —Ç–æ—á–Ω–æ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏", type: "C" },
                    { text: "–ª—é–±–ª—é –±—ã—Ç—å –≤ —Ü–µ–Ω—Ç—Ä–µ –≤–Ω–∏–º–∞–Ω–∏—è", type: "I" },
                    { text: "—Å—Ç–∞—Ä–∞—é—Å—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≥–∞—Ä–º–æ–Ω–∏—é", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "—Å—Ç—Ä–µ–º–ª—é—Å—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é", type: "D" },
                    { text: "—Ü–µ–Ω—é —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –ø–æ—Ä—è–¥–æ–∫", type: "C" },
                    { text: "—É–º–µ—é —É–±–µ–∂–¥–∞—Ç—å –ª—é–¥–µ–π", type: "I" },
                    { text: "—Ç–µ—Ä–ø–µ–ª–∏–≤ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–Ω", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "—Ä–µ—à–∞—é –∑–∞–¥–∞—á–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ", type: "D" },
                    { text: "–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é —Å–Ω–∞—á–∞–ª–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å", type: "C" },
                    { text: "–ª–µ–≥–∫–æ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é –∫–ª–∏–µ–Ω—Ç–∞", type: "I" },
                    { text: "–Ω–∞–¥—ë–∂–µ–Ω –∏ –ø–æ—Å—Ç–æ—è–Ω–µ–Ω", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é —Ä—É–∫–æ–≤–æ–¥–∏—Ç—å –¥—Ä—É–≥–∏–º–∏", type: "D" },
                    { text: "–æ—Å—Ç–æ—Ä–æ–∂–µ–Ω –≤ –¥–µ–π—Å—Ç–≤–∏—è—Ö", type: "C" },
                    { text: "–æ–ø—Ç–∏–º–∏—Å—Ç –∏ –¥—Ä—É–∂–µ–ª—é–±–µ–Ω", type: "I" },
                    { text: "—Å—Ç–∞–±–∏–ª–µ–Ω –∏ –≤–µ—Ä–µ–Ω –¥—Ä—É–∑—å—è–º", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "—Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª—ë–Ω–Ω—ã–π –∏ —Ä–µ—à–∏—Ç–µ–ª—å–Ω—ã–π", type: "D" },
                    { text: "—Å–∫—Ä—É–ø—É–ª—ë–∑–Ω—ã–π –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π", type: "C" },
                    { text: "—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∏ –æ—Ç–∫—Ä—ã—Ç—ã–π", type: "I" },
                    { text: "—É—Ä–∞–≤–Ω–æ–≤–µ—à–µ–Ω–Ω—ã–π –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–≥–æ—Ç–æ–≤ –±—Ä–∞—Ç—å –Ω–∞ —Å–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å", type: "D" },
                    { text: "–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å", type: "C" },
                    { text: "–ª–µ–≥–∫–æ –∑–∞–≤–æ–∂—É —Ä–∞–∑–≥–æ–≤–æ—Ä", type: "I" },
                    { text: "–∏–∑–±–µ–≥–∞—é –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é –ø–æ–±–µ–∂–¥–∞—Ç—å", type: "D" },
                    { text: "–ª—é–±–ª—é –ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø–µ—Ä—ë–¥", type: "C" },
                    { text: "–ª—é–±–ª—é —Ä–∞–∑–≤–ª–µ–∫–∞—Ç—å –ª—é–¥–µ–π", type: "I" },
                    { text: "—Ü–µ–Ω—é —Å–ø–æ–∫–æ–π–Ω—ã–π —Ä–∏—Ç–º –∂–∏–∑–Ω–∏", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–±—ã—Å—Ç—Ä–æ –ø—Ä–∏–Ω–∏–º–∞—é —Ä–µ—à–µ–Ω–∏—è", type: "D" },
                    { text: "–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ñ–∞–∫—Ç—ã", type: "C" },
                    { text: "–ª—é–±–ª—é –±—ã—Ç—å –≤ —Ü–µ–Ω—Ç—Ä–µ –∫–æ–º–ø–∞–Ω–∏–∏", type: "I" },
                    { text: "–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏—è—Ö", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ø—Ä–æ—è–≤–ª—è—é –Ω–∞–ø–æ—Ä–∏—Å—Ç–æ—Å—Ç—å", type: "D" },
                    { text: "–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é —Ç–æ—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏", type: "C" },
                    { text: "–ª–µ–≥–∫–æ –∑–∞—Ä–∞–∂–∞—é –¥—Ä—É–≥–∏—Ö —ç–Ω—Ç—É–∑–∏–∞–∑–º–æ–º", type: "I" },
                    { text: "–ø–æ—Å—Ç–æ—è–Ω–µ–Ω –≤ –ø—Ä–∏–≤—ã—á–∫–∞—Ö", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–≥–æ—Ç–æ–≤ —Å–ø–æ—Ä–∏—Ç—å —Ä–∞–¥–∏ —Å–≤–æ–µ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è", type: "D" },
                    { text: "–ª—é–±–ª—é –ø–æ—Ä—è–¥–æ–∫ –∏ –ø—Ä–∞–≤–∏–ª–∞", type: "C" },
                    { text: "–¥—Ä—É–∂–µ–ª—é–±–µ–Ω –∏ –æ–±—â–∏—Ç–µ–ª–µ–Ω", type: "I" },
                    { text: "–Ω–∞–¥—ë–∂–µ–Ω –∏ –ø—Ä–µ–¥–∞–Ω–Ω—ã–π", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é —Å—Ç–∞–≤–∏—Ç—å –∞–º–±–∏—Ü–∏–æ–∑–Ω—ã–µ —Ü–µ–ª–∏", type: "D" },
                    { text: "–ª—é–±–ª—é –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ñ–∞–∫—Ç—ã", type: "C" },
                    { text: "–ª—é–±–ª—é –±—ã—Ç—å –¥—É—à–æ–π –∫–æ–º–ø–∞–Ω–∏–∏", type: "I" },
                    { text: "—Ü–µ–Ω—é –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "—Å—Ç–∞—Ä–∞—é—Å—å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç", type: "D" },
                    { text: "–ª—é–±–ª—é –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏", type: "C" },
                    { text: "–ª–µ–≥–∫–æ –Ω–∞—Ö–æ–∂—É –æ–±—â–∏–π —è–∑—ã–∫", type: "I" },
                    { text: "—Ü–µ–Ω—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é –ø–æ–±–µ–∂–¥–∞—Ç—å –≤–æ –≤—Å—ë–º", type: "D" },
                    { text: "–ª—é–±–ª—é —Ç–æ—á–Ω–æ—Å—Ç—å –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å", type: "C" },
                    { text: "–ª—é–±–ª—é –≤–µ—Å–µ–ª–∏—Ç—å—Å—è —Å –ª—é–¥—å–º–∏", type: "I" },
                    { text: "—Å–ø–æ–∫–æ–µ–Ω –∏ —É—Ä–∞–≤–Ω–æ–≤–µ—à–µ–Ω", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "—É–º–µ—é –≤–ª–∏—è—Ç—å –Ω–∞ –ª—é–¥–µ–π", type: "D" },
                    { text: "—Å–ª–µ–¥—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º", type: "C" },
                    { text: "—É–º–µ—é —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ", type: "I" },
                    { text: "–≤–µ—Ä–µ–Ω —Å–≤–æ–∏–º –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç—è–º", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é —É–ø—Ä–∞–≤–ª—è—Ç—å", type: "D" },
                    { text: "–ª—é–±–ª—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å", type: "C" },
                    { text: "–ª—é–±–ª—é —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏–∏", type: "I" },
                    { text: "–ª—é–±–ª—é –ø–æ–º–æ–≥–∞—Ç—å –¥—Ä—É–≥–∏–º", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "—Å—Ç—Ä–µ–º–ª—é—Å—å –∫ –ª–∏–¥–µ—Ä—Å—Ç–≤—É", type: "D" },
                    { text: "–ª—é–±–ª—é —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", type: "C" },
                    { text: "–ª—é–±–ª—é –±—ã—Ç—å –æ–±—â–∏—Ç–µ–ª—å–Ω—ã–º", type: "I" },
                    { text: "–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º –∏ –Ω–∞–¥—ë–∂–µ–Ω", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é –≤–ª–∏—è—Ç—å –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç", type: "D" },
                    { text: "–ª—é–±–ª—é —Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞–º", type: "C" },
                    { text: "–ª—é–±–ª—é –≤–¥–æ—Ö–Ω–æ–≤–ª—è—Ç—å –¥—Ä—É–≥–∏—Ö", type: "I" },
                    { text: "–ª—é–±–ª—é –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≥–∞—Ä–º–æ–Ω–∏—é", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–±—ã—Å—Ç—Ä–æ —Ä–µ–∞–≥–∏—Ä—É—é –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è", type: "D" },
                    { text: "–ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é —Å–Ω–∞—á–∞–ª–∞ –ø–æ–¥—É–º–∞—Ç—å", type: "C" },
                    { text: "–ª—é–±–ª—é –∑–∞–≤–æ–¥–∏—Ç—å –Ω–æ–≤—ã–µ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞", type: "I" },
                    { text: "–ª—é–±–ª—é –ø—Ä–∏–≤—ã—á–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é —Ä–∏—Å–∫–æ–≤–∞—Ç—å —Ä–∞–¥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞", type: "D" },
                    { text: "–ª—é–±–ª—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å—ë –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑", type: "C" },
                    { text: "–ª—é–±–ª—é –±—ã—Ç—å –¥—É—à–æ–π –∫–æ–º–ø–∞–Ω–∏–∏", type: "I" },
                    { text: "–ª—é–±–ª—é —Å–ø–æ–∫–æ–π–Ω—ã–π —Ä–∏—Ç–º", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é —Å–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç—å—Å—è", type: "D" },
                    { text: "–ª—é–±–ª—é —Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å", type: "C" },
                    { text: "–ª—é–±–ª—é –æ–±—â–µ–Ω–∏–µ –∏ –≤–Ω–∏–º–∞–Ω–∏–µ", type: "I" },
                    { text: "–ª—é–±–ª—é –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç—å –∏ –ø–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–Ω–∞–ø–æ—Ä–∏—Å—Ç –∏ —Ä–µ—à–∏—Ç–µ–ª–µ–Ω", type: "D" },
                    { text: "–∞–∫–∫—É—Ä–∞—Ç–µ–Ω –∏ —Ç–æ—á–µ–Ω", type: "C" },
                    { text: "—Ö–∞—Ä–∏–∑–º–∞—Ç–∏—á–µ–Ω –∏ —ç–Ω–µ—Ä–≥–∏—á–µ–Ω", type: "I" },
                    { text: "—É—Ä–∞–≤–Ω–æ–≤–µ—à–µ–Ω –∏ —Ç–µ—Ä–ø–µ–ª–∏–≤", type: "S" }
                ]
            },
            {
                statements: [
                    { text: "–ª—é–±–ª—é —Ä—É–∫–æ–≤–æ–¥–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–æ–º", type: "D" },
                    { text: "–ª—é–±–ª—é –ø—Ä–æ–≤–µ—Ä—è—Ç—å –¥–µ—Ç–∞–ª–∏", type: "C" },
                    { text: "–ª—é–±–ª—é —Ä–∞–∑–≤–ª–µ–∫–∞—Ç—å –∏ –æ–±—â–∞—Ç—å—Å—è", type: "I" },
                    { text: "–ª—é–±–ª—é —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –∏ –ø–æ—Ä—è–¥–æ–∫", type: "S" }
                ]
            }
        ];

        function createTestBlocks() {
            const container = document.getElementById('testBlocks');
            
            discBlocks.forEach((block, blockIndex) => {
                const blockDiv = document.createElement('div');
                blockDiv.className = 'block';
                
                const blockTitle = document.createElement('h4');
                blockTitle.textContent = `–ë–ª–æ–∫ ${blockIndex + 1}`;
                blockDiv.appendChild(blockTitle);
                
                // –°–æ–∑–¥–∞–µ–º –≥—Ä—É–ø–ø—É —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ –¥–ª—è "–Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–µ"
                const mostLikeGroup = document.createElement('div');
                const mostLikeLabel = document.createElement('p');
                mostLikeLabel.innerHTML = '<strong>‚úî –ù–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –º–µ–Ω—è:</strong>';
                mostLikeLabel.style.marginBottom = '10px';
                mostLikeGroup.appendChild(mostLikeLabel);
                
                block.statements.forEach((statement, statementIndex) => {
                    const statementDiv = document.createElement('div');
                    statementDiv.className = 'statement';
                    
                    const label = document.createElement('label');
                    
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = `block_${blockIndex}_most`;
                    radio.value = statement.type;
                    radio.required = true;
                    
                    const text = document.createElement('span');
                    text.textContent = statement.text;
                    
                    label.appendChild(radio);
                    label.appendChild(text);
                    statementDiv.appendChild(label);
                    mostLikeGroup.appendChild(statementDiv);
                });
                
                // –°–æ–∑–¥–∞–µ–º –≥—Ä—É–ø–ø—É —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫ –¥–ª—è "–Ω–∞–∏–º–µ–Ω–µ–µ –ø–æ—Ö–æ–∂–µ"
                const leastLikeGroup = document.createElement('div');
                const leastLikeLabel = document.createElement('p');
                leastLikeLabel.innerHTML = '<strong>‚úñ –ù–∞–∏–º–µ–Ω–µ–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ –º–µ–Ω—è:</strong>';
                leastLikeLabel.style.marginBottom = '10px';
                leastLikeLabel.style.marginTop = '20px';
                leastLikeGroup.appendChild(leastLikeLabel);
                
                block.statements.forEach((statement, statementIndex) => {
                    const statementDiv = document.createElement('div');
                    statementDiv.className = 'statement';
                    
                    const label = document.createElement('label');
                    
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = `block_${blockIndex}_least`;
                    radio.value = statement.type;
                    radio.required = true;
                    
                    const text = document.createElement('span');
                    text.textContent = statement.text;
                    
                    label.appendChild(radio);
                    label.appendChild(text);
                    statementDiv.appendChild(label);
                    leastLikeGroup.appendChild(statementDiv);
                });
                
                blockDiv.appendChild(mostLikeGroup);
                blockDiv.appendChild(leastLikeGroup);
                container.appendChild(blockDiv);
            });
        }

        function calculateResults() {
            const scores = { D: 0, I: 0, S: 0, C: 0 };
            
            discBlocks.forEach((block, blockIndex) => {
                // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                const mostLike = document.querySelector(`input[name="block_${blockIndex}_most"]:checked`);
                const leastLike = document.querySelector(`input[name="block_${blockIndex}_least"]:checked`);
                
                if (mostLike && leastLike) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–µ –≤—ã–±—Ä–∞–Ω–æ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                    if (mostLike.value === leastLike.value) {
                        alert(`–í –±–ª–æ–∫–µ ${blockIndex + 1} –Ω–µ–ª—å–∑—è –≤—ã–±—Ä–∞—Ç—å –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–∞–∫ "–Ω–∞–∏–±–æ–ª–µ–µ" –∏ "–Ω–∞–∏–º–µ–Ω–µ–µ" –ø–æ—Ö–æ–∂–µ–µ.`);
                        return null;
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º +1 –∑–∞ "–Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–µ"
                    scores[mostLike.value]++;
                    // –í—ã—á–∏—Ç–∞–µ–º 1 –∑–∞ "–Ω–∞–∏–º–µ–Ω–µ–µ –ø–æ—Ö–æ–∂–µ"
                    scores[leastLike.value]--;
                }
            });
            
            return scores;
        }


        async function submitResults(candidateData) {
            try {
                const response = await fetch('/api/submit-disc', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(candidateData)
                });

                const result = await response.json();
                
                if (response.ok) {
                    return { success: true, data: result };
                } else {
                    return { success: false, error: result.error || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞' };
                }
            } catch (error) {
                return { success: false, error: '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏' };
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
        document.addEventListener('DOMContentLoaded', function() {
            createTestBlocks();
            
            document.getElementById('discForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
                // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
                const candidateData = JSON.parse(localStorage.getItem('candidateData'));
                if (!candidateData) {
                    alert('–û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –∑–∞–Ω–æ–≤–æ.');
                    window.location.href = '/entry.html';
                    return;
                }
                
                const scores = calculateResults();
                if (scores === null) return;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ –±–ª–æ–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
                const totalBlocks = discBlocks.length;
                let filledBlocks = 0;
                
                for (let i = 0; i < totalBlocks; i++) {
                    const mostLike = document.querySelector(`input[name="block_${i}_most"]:checked`);
                    const leastLike = document.querySelector(`input[name="block_${i}_least"]:checked`);
                    if (mostLike && leastLike) filledBlocks++;
                }
                
                if (filledBlocks < totalBlocks) {
                    alert(`–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –±–ª–æ–∫–∏ —Ç–µ—Å—Ç–∞. –ó–∞–ø–æ–ª–Ω–µ–Ω–æ: ${filledBlocks} –∏–∑ ${totalBlocks}`);
                    return;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                document.getElementById('loading').classList.add('show');
                document.getElementById('submitBtn').disabled = true;
                document.getElementById('errorMessage').classList.remove('show');
                
                // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                const testData = {
                    name: candidateData.fullName,
                    telegram: candidateData.telegram,
                    scores: scores
                };
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                const result = await submitResults(testData);
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
                document.getElementById('loading').classList.remove('show');
                
                if (result.success) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                    updateTestProgress(1);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                    document.getElementById('successMessage').classList.add('show');
                    
                    // –°–∫—Ä–æ–ª–ª–∏–º –∫ —Å–æ–æ–±—â–µ–Ω–∏—é
                    document.getElementById('successMessage').scrollIntoView({ behavior: 'smooth' });
                } else {
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
                    document.getElementById('errorMessage').classList.add('show');
                    document.getElementById('errorMessage').scrollIntoView({ behavior: 'smooth' });
                    document.getElementById('submitBtn').disabled = false;
                }
            });
        });
    </script>
    
    <!-- –û—Ç–º–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è -->
    <div id="update-timestamp" class="update-timestamp"></div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const timestampElement = document.getElementById('update-timestamp');
            if (timestampElement) {
                // –°—Ç–∞—Ç–∏—á–Ω–∞—è –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
                timestampElement.textContent = `–û–±–Ω–æ–≤–ª–µ–Ω–æ: 26.09.2025, 04:00:06`;
            }
        });
    </script>
</body>
</html>
